<html>
<head>
<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"></script>
<script src="js/circle-progress.min.js"></script>
<style>
.loading { margin: auto; }

.loading span {
  line-height: 32px;
  margin-left: 12px;
  font-size: 16px;
  vertical-align: middle;
}

.loading img { vertical-align: middle; }

.loading_wrp {
  background-color: #FFF;
  display: block;
  height: 100%;
  left: 0;
  opacity: 0.5;
  filter: alpha(opacity=50);
  position: absolute;
  top: 0;
  width: 100%;
  z-index: 1020;
}

.loading_wrp .x16 span {
  line-height: 16px;
  font-size: 12px;
  margin-left: 6px;
}

.loading_wrp .x32 img {
  width: 32px;
  height: 32px;
}
</style>
<script>
function saveTextAsFile(tosave,fileext,filename)
{
    var a = document.createElement('a');
    a.style = "display: none";  
    var blob= new Blob([tosave], {type:'text/plain'});
    var url = window.URL.createObjectURL(blob);
    var filename = filename+fileext;
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    setTimeout(function(){
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);  
    }, 1000);
}

function convert() {
    var data = new FormData(); // das ist unser Daten-Objekt ...
    data.append('file', document.getElementById('files').files[0]); // ... an die wir unsere Datei anhängen
    data.append('namespace',document.getElementById('namespace').value);
    data.append('provider',document.getElementById('provider').value);
    data.append('license',document.getElementById('license').value);
    data.append('origin',document.getElementById('origin').value);
    data.append('triplestore',document.getElementById('triplestore').value);
    data.append('triplestoregraph',document.getElementById('triplestoregraph').value);
    data.append('triplestoreuser',document.getElementById('triplestoreuser').value);
    data.append('triplestorepasswd',document.getElementById('triplestorepasswd').value);
    $('#loading').show();
    $.ajax({
       url: 'rest/service/convertGML', // Wohin soll die Datei geschickt werden?
       data: data,          // Das ist unser Datenobjekt.
       type: 'POST',         // HTTP-Methode, hier: POST
       processData: false,
       contentType: false,
       // und wenn alles erfolgreich verlaufen ist, schreibe eine Meldung
       // in das Response-Div
       success: function(data) { 
    	    $('#loading').hide();
    	   saveTextAsFile(data,".ttl","result");
       }
    });
 }
 
function toggleTripleStore() {
	  var x = document.getElementById("triplestorediv");
	  if (x.style.display === "none") {
	    x.style.display = "block";
	  } else {
	    x.style.display = "none";
	  }
	}
</script>
</head>

<body>
	<h1>GMLConverter: Convert your GML Files to RDF</h1>
<div id="spinner">
  <img src="ajax-loader.gif" alt="Loading" id="loading" style="display: none"/>
</div>
	   <p>
		Select a file : <input type="file" name="file" id="files" size="45" /><br/><br/>
		<table>
			   <tr><td>Individual Namespace:</td><td> <input type="url" name="namespace" id="namespace"/></td></tr>
			   <tr><td>Provider:</td><td> <input type="text" name="provider" id="provider" value="GDI-DE"/></td></tr>
			   <tr><td>License URL:</td><td> <input type="url" name="license" id="license" value=""/></td></tr>
			   <tr><td>Origin URL:</td><td> <input type="text" name="origin" id="origin"/></td></tr>
		</table>
	   </p>
	   <input type="checkbox" id="importTripleStore" onChange="toggleTripleStore()">Import to a triple store
	   <p id="triplestorediv" style="display:none;">
	   I want to import the file into the following triple store:<br/>
	    <table>
	   <tr><td>TripleStore:</td><td> <input type="text" name="triplestore" id="triplestore" value=""/></td></tr>
	   <tr><td>Graph:</td><td> <input type="text" name="triplestoregraph" id="triplestoregraph" value=""/></td></tr>
	   <tr><td>Username:</td><td> <input type="text" name="triplestoreuser" id="triplestoreuser" value=""/></td></tr>
 	   <tr><td>Password:</td><td> <input type="text" name="triplestorepasswd" id="triplestorepasswd" value=""/></td></tr>
 	   </table>
	   </p>
	   <button id="uploadButton" onclick="convert()">Upload It</button>
 
</body>
</html>